# Logic App 05 â€“ Tamper Trigger Parameter and Abuse Storage Table  

## ğŸ“ Scenario  
Logic Apps use connectors that perform defined actions when triggered.  
When misconfigured or when the trigger URL is exposed, they could reveal sensitive data. 
Abuse the exposed trigger URL and obtain the flag.  

---

## ğŸ“– Overview  

### What is a SAS URL (Shared Access Signature URL)?  
A **SAS URL** is a URL that contains a shared access signature token.  
It allows secure access to specific resources within an Azure Storage account for a limited period, without requiring the account key.  
SAS URLs provide a way to grant granular access permissions to clients or applications without exposing the storage account keys..  

ğŸ’¡ *Hint: Access resources without exposing keys.*  

<img width="745" height="411" alt="image" src="https://github.com/user-attachments/assets/231de4f7-ef53-4357-9960-7e5a5c1f0239" />

## ğŸ› ï¸ Solution  

- Copy the Logic App trigger URL and paste it into the browser.  
- Observe the `{name}` parameter in the URL.  
- No output is shown initially.  
- Use the provided **SAS URL** with **Azure Storage Explorer**.  
- Open the tool â†’ *Open connect dialog* â†’ Select **Table**.  
- Choose **Shared access signature URL (SAS)**.  
- Paste the SAS URL â†’ Click **Next**.  
- Paste both URLs in the browser and observe behavior.  
- Use **Burp Suite** to intercept and replay the Logic App request.  
- Send the request and monitor the table in **Azure Storage Explorer**.  

<img width="1909" height="1056" alt="image" src="https://github.com/user-attachments/assets/1ebd58be-5e9f-40bb-ba02-54a902aa6cbb" />

- Now send it to Repeater and change the Parameter with admin and send the request once done go back to Azure Storage Explorer and make while connection we've used Table to put the SAS URL then refresh the Page

<img width="1896" height="853" alt="image" src="https://github.com/user-attachments/assets/e9877dcd-e25e-40f0-881f-9af1d5dc8872" />

<img width="1889" height="956" alt="image" src="https://github.com/user-attachments/assets/9db91cbd-3f01-44a1-a234-be9ebe8aca9c" />

## ğŸ”“ Exploitation  

- Copy the URL and open it in a browser to trigger the Logic App.  
- Observe the `{name}` parameter in the URL.  
- Initially, no output is shown.  
- Connect to the storage account using the SAS URL in **Storage Explorer**.  
- On connecting, a table entry is found, but no sensitive data.  
- Further enumeration of the `{name}` parameter reveals interesting behavior:  
  - Changing `{name}` to `test` â†’ Creates a new entry in the table with user `test`.  
  - Changing `{name}` to `admin` â†’ Creates a new entry in the table containing the **flag**.  

âœ… **Flag:**  : asmritbh830asmostln830 

âš ï¸ Impact

- The Logic App using a request trigger with parameters was vulnerable to IDOR.
- When triggered with the "admin" parameter, the Logic App revealed sensitive data.
- Here the Logic App is integrated with multiple other Azure services â€” in this case, a Storage Table.
- The exposed trigger URL allowed sensitive data from the table to be accessed.

ğŸ“š References

- Logic Apps Docs - https://learn.microsoft.com/en-us/azure/logic-apps/logic-apps-overview
- Table Storage Docs - https://learn.microsoft.com/en-us/azure/storage/tables/table-storage-overview
- Azure Table Connector - https://learn.microsoft.com/en-us/connectors/azuretables/
- Azure Storage Explorer - https://azure.microsoft.com/en-in/products/storage/storage-explorer

## ğŸ“– Summary  

### ğŸ” What it means  

- A Logic App was configured with a request trigger that accepted a parameter (`{name}`) directly from the URL.  
- The parameter was not validated, allowing anyone to tamper with it.  
- When changed, the Logic App wrote entries into an **Azure Storage Table** based on the parameter value.  

---

### âš™ï¸ How it worked 

- Opening the Logic App trigger URL revealed the `{name}` parameter.  
- Supplying values like `test` or `admin` created new entries in the Storage Table.  
- Using `admin` as the parameter resulted in a table entry containing the **flag**.  
- This is an example of **IDOR (Insecure Direct Object Reference)** â€” direct access to resources without proper checks.  

---

### ğŸ” Why it needs to be secure  

- **Data leakage**: Sensitive information (flags, secrets, internal data) can be exposed.  
- **Abuse of resources**: Attackers can create unauthorized entries in the table.  
- **Privilege escalation**: Malicious users can impersonate privileged roles (like `admin`) by changing a URL parameter.  
- **Compliance risk**: Exposing data through insecure triggers violates security best practices and regulatory requirements.  

---

ğŸ‘‰ **In short:**  

Tampering with trigger parameters allowed unauthorized creation of table entries and exposure of sensitive data.  
Logic Apps must validate inputs and restrict access to prevent **IDOR attacks**.  

