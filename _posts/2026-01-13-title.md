# Logic App 04 â€“ Tamper Trigger Parameter and Abuse Storage Queue  

## ğŸ“ Scenario  
In certain scenarios, a Logic App might trigger and reveal sensitive data. Leverage this information to obtain the flag.  

---

## ğŸ“– Overview  

### What is a SAS URL (Shared Access Signature URL)?  
A **SAS URL** is a URL that contains a shared access signature token. It allows secure access to specific resources within an Azure Storage account for a limited period, without requiring the account key.  
SAS URLs provide a way to grant granular access permissions to clients or applications without exposing the storage account keys.  

### What is IDOR?  
**IDOR (Insecure Direct Object Reference)** is a type of security vulnerability that occurs when an application provides direct access to objects based on user-supplied input.  
Attackers can manipulate input, such as URLs or form parameters, to gain unauthorized access to data.  

ğŸ’¡ *Hint: Access resources without exposing keys.*  

---

## ğŸ› ï¸ Solution  

<img width="745" height="410" alt="image" src="https://github.com/user-attachments/assets/56c4be26-366b-49de-8621-af6c233b6dde" />

- Copy the Logic App trigger URL and paste it into the browser.  
- Observe the `{name}` parameter in the URL.  
- No output is shown initially.  
- Use the provided **SAS URL** with **Azure Storage Explorer**.  
- Open the tool â†’ *Open connect dialog* â†’ Select **Queue**.  
- Choose **Shared access signature URL (SAS)**.  
- Paste the SAS URL â†’ Click **Next**.  
- Paste both URLs in the browser and observe behavior.  

<img width="1897" height="936" alt="image" src="https://github.com/user-attachments/assets/964b69f7-3c57-4261-99cd-1042351c1f9b" />

-Intercept the URL and Send it to Repeater and change the Parameter with '(admin)' in the URL and send the request 

<img width="1914" height="867" alt="image" src="https://github.com/user-attachments/assets/7692d9d9-68b6-4734-8d02-e2410b855222" />

-Once the output comes up as shown above go to Azure storage Explore which has been open Already with SAS URL and refresh Once done you will Admin with Flags

<img width="1889" height="857" alt="image" src="https://github.com/user-attachments/assets/f93f8a64-b91a-4b81-b7af-1c6f23c9d362" />

## ğŸ”“ Exploitation  

- On connecting to the storage account, a message is found inside the queue, but initially no sensitive data.  
- Further enumeration of the `{name}` parameter reveals interesting behavior:  
- Changing `{name}` to `test` â†’ Creates a new message named **test** in the queue.  
- Changing `{name}` to `admin` â†’ Creates a new message named **admin** containing the **flag**.  

âœ… **Flag:**  : askhgjor830asqdaeou830 

âš ï¸ Impact

The Logic App using a request trigger with parameters was vulnerable to IDOR.
When triggered with the "admin" parameter, the Logic App revealed sensitive data stored in the queue.


ğŸ“š References 

- Logic Apps Docs - https://learn.microsoft.com/en-us/azure/logic-apps/logic-apps-overview
- Storage Queues Docs - https://learn.microsoft.com/en-us/azure/storage/queues/storage-queues-introduction
- Azure Queue Connector - https://learn.microsoft.com/en-us/connectors/azurequeues/
- Azure Storage Explorer - https://azure.microsoft.com/en-in/products/storage/storage-explorer

## ğŸ“– Summary  

### ğŸ” What it means  
- A Logic App was set up with a request trigger that accepted a parameter (`{name}`) directly from the URL.  
- That parameter was not properly validated, so anyone could change it (tamper with it).  
- When changed, the Logic App wrote messages into an Azure Storage Queue based on the parameter value.  

---

### âš™ï¸ How it worked  
- You open the Logic App trigger URL â†’ it has `{name}` in the path.  
- Supplying values like `test` or `admin` created new queue messages in Azure Storage.  
- By using `admin` as the parameter, the Logic App wrote a message containing the **flag** into the queue.  
- This is an example of **IDOR (Insecure Direct Object Reference)** â€” direct access to resources without proper checks.  

---

### ğŸ” Why it needs to be secure  
- **Data leakage**: Sensitive information (like flags, secrets, or internal data) can be exposed.  
- **Abuse of resources**: Attackers can flood queues or create unauthorized entries.  
- **Privilege escalation**: Malicious users can impersonate privileged roles (like `admin`) just by changing a URL parameter.  
- **Compliance risk**: Exposing data through insecure triggers violates security best practices and regulatory requirements.  

---

ğŸ‘‰ **In short:**  

Tampering with trigger parameters allowed unauthorized creation of queue messages and exposure of sensitive data.  
Logic Apps must validate inputs and restrict access to prevent **IDOR attacks**.  
