# Logic App 03 ‚Äì Tamper Trigger Parameter and Abuse Storage Container  

## üìù Scenario  
In certain scenarios, A Logic App might trigger and reveal sensitive data. Leverage this information to obtain the flag.  

---

## üìñ Overview  

### What is a Logic App?  
Azure Logic Apps is a cloud-based service provided by Microsoft Azure that allows us to create and run automated workflows and integrate various applications, systems, and services.  

### What is a Requests Trigger?  
In Azure Logic Apps, the **Requests trigger** is a commonly used trigger that initiates a workflow whenever an HTTP request is received.  

### What is IDOR?  
**IDOR (Insecure Direct Object Reference)** is a security vulnerability that occurs when an application provides direct access to objects based on user-supplied input.  
Attackers can manipulate inputs (like URLs or parameters) to gain unauthorized access to data.  

üí° *Hint: IDORs are common web application vulnerabilities. Consider different HTTP methods in a web request.*  

---

## üõ†Ô∏è Solution  

<img width="727" height="438" alt="image" src="https://github.com/user-attachments/assets/604b06bc-0acc-4606-b977-2e13c61ee9d1" />


### Attack Path  
- Copy the Logic App trigger URL and paste it into the browser.  
- Observe the `{name}` parameter in the URL.  
- No output is shown initially.  
- Use the provided **Azure Storage Container URL** with **Azure Storage Explorer**.  
- Open the tool ‚Üí *Open connect dialog* ‚Üí Select **Blob container**.  
- Choose **Anonymously (my blob container allows public access)**.  
- Paste the container URL ‚Üí Click **Next**.  
- Paste both URLs in the browser and observe behavior.  
- Use **Burp Suite** to intercept and replay the Logic App request:

URL : GET /workflows/f908e25b039d4da48ab4f6d49dd307e8/triggers/manual/paths/invoke/admin?api-version=2018-07-01-preview&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=v9ZPtbsV8jb68kNs-iu1tPyJJS1T8LFsHjKf3GBzVgY HTTP/1.1

<img width="1773" height="947" alt="image" src="https://github.com/user-attachments/assets/3b4c6fc9-d273-4dae-a33f-08bb6b5abdea" />

- Go to Repeater & Make sure URL is Admin change the request by right click and send the request

<img width="1417" height="885" alt="image" src="https://github.com/user-attachments/assets/000a52cc-1c76-4e87-bb18-1282c3d23c54" />

- Send the request and monitor the container in **Azure Storage Explorer**.
  
<img width="1153" height="836" alt="image" src="https://github.com/user-attachments/assets/6823ca9e-2bb3-4b50-b3eb-dc4361a60c02" />

- Now go to **Azure Storage Container URL** with **Azure Storage Explorer**

<img width="1835" height="958" alt="image" src="https://github.com/user-attachments/assets/8547bf65-4850-46d6-bd9d-33cb4e5e24d1" />

 - Once we open Admin.txt we have the Flag 
---

## üîì Exploitation  
- On connecting, a blob is found inside the container, but initially no sensitive data.  
- Further enumeration of the `{name}` parameter reveals interesting behavior:  
  - Changing `{name}` to `test` ‚Üí Creates a blob named **test** in the container.  
  - Changing `{name}` to `admin` ‚Üí Creates a blob named **admin** containing the flag.
  

‚úÖ **Flag:**  ashrujsm821ashmozuf821



‚ö†Ô∏è Impact

The Logic App using a request trigger with parameters was vulnerable to IDOR.
When triggered with the "admin" parameter, the Logic App revealed sensitive data stored in the blob container.


üìö References

Logic Apps Docs - https://learn.microsoft.com/en-us/azure/logic-apps/logic-apps-overview
Storage Blob Docs - https://learn.microsoft.com/en-us/azure/storage/blobs/storage-blobs-overview
Azure Storage Explorer -https://azure.microsoft.com/en-in/products/storage/storage-explorer
Blob Storage Connector - https://learn.microsoft.com/en-us/azure/connectors/connectors-create-api-azureblobstorage?tabs=consumption
Request/ Response Connector - https://learn.microsoft.com/en-us/azure/connectors/connectors-native-reqres?tabs=consumption
















